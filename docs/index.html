<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>1365 Â· ì„œìš¸ ( 1365 ì›¹ì‚¬ì´íŠ¸ ì ê²€ ì¤‘ )</title>

  <!-- ê¸°ë³¸ ì„¤ëª… -->
  <meta name="description" content="ëª¨ì§‘/ì‹ ì²­ì¸ì› ê²€ìƒ‰ ê°€ëŠ¥í•œ ì„œìš¸ ì§€ì—­ ë´‰ì‚¬ ê³µê³  í˜ì´ì§€.">
  <meta property="og:title" content="1365 Â· ì„œìš¸">
  <meta property="og:description" content="ëª¨ì§‘/ì‹ ì²­ì¸ì› ê²€ìƒ‰ ê°€ëŠ¥í•œ ì„œìš¸ ì§€ì—­ ë´‰ì‚¬ ê³µê³  í˜ì´ì§€.">
  <!-- ê³µìœ  ì¸ë„¤ì¼(ì ˆëŒ€ê²½ë¡œ) -->
  <meta property="og:image" content="https://bjeon01.github.io/1365-vols-pages/data/logo.png">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="ko_KR">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://bjeon01.github.io/1365-vols-pages/data/logo.png">

  <!-- íŒŒë¹„ì½˜ -->
  <link rel="icon" href="./data/logo.png?v=1" type="image/png" sizes="any">
  <link rel="apple-touch-icon" href="./data/logo.png?v=1">
  <meta name="theme-color" content="#111827">

  <style>
    :root {
      --fg: #111;
      --muted: #666;
      --line: #e5e7eb;
      --bg: #fff;
      --accent: #111827;

      /* ë¨¸ë¦¬í–‰(ì—°í•œ ì²­ë¡) */
      --brand-soft: #EAF7FA;
      --brand-soft-border: #C8E6EE;

      /* ë²„íŠ¼ í†¤(ë¨¸ë¦¬í–‰ë³´ë‹¤ ì‚´ì§ ì§„í•˜ê²Œ) */
      --btn-brand: #D6EEF4;
      --btn-brand-border: #BDE3ED;

      --brand-soft-text: #0f2d34;
      --ring: rgba(148,210,223,.35);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', 'Apple SD Gothic Neo', sans-serif;
      color: var(--fg);
      background: var(--bg);
    }

    .wrap { width: 100%; margin: 24px 0; padding: 0 16px; }
    h1 { font-size: 22px; margin: 0; font-weight: 700; line-height: 1.15; letter-spacing: -0.01em; }
    .meta { color: var(--muted); font-size: 13px; }

    .header {
      display: grid;
      grid-template-columns: auto 1fr;
      column-gap: 10px;
      row-gap: 2px;
      align-items: center;
      margin: 0 0 12px;
    }
    /* ë¡œê³  ë§í¬(ìƒˆë¡œê³ ì¹¨) */
    .logo-link{
      display:inline-block;
      line-height:0;
      border-radius:8px;
      text-decoration:none;
      grid-row: 1 / 3;
    }
    .logo-link:focus-visible{ outline: 3px solid var(--ring); }
    .header .logo{
      width: 52px;
      height: auto;
      object-fit: contain;
      display: block;
      cursor: pointer;
    }

    .panel {
      border: 1px solid var(--line); border-radius: 10px; padding: 12px; background: #fafafa;
      margin-bottom: 16px;
    }
    .row { display: grid; gap: 10px; }
    @media (min-width: 720px) {
      .row { grid-template-columns: repeat(6, minmax(0,1fr)); align-items: end; }
      .header .logo { width: 56px; }
    }

    label { font-size: 12px; color: var(--muted); display: block; margin: 4px 0; }
    input[type="text"], input[type="date"], input[type="number"], select {
      width: 100%; padding: 8px 10px; border: 1px solid var(--line); border-radius: 8px; background: #fff;
      font-size: 14px; outline: none;
    }
    input:focus, select:focus { box-shadow: 0 0 0 3px var(--ring); border-color: var(--btn-brand-border); }

    .actions { display: flex; gap: 8px; justify-content: flex-end; margin-top: 8px; }
    button {
      border: 1px solid var(--line); padding: 8px 12px; border-radius: 8px; background: #fff; cursor: pointer; font-size: 14px;
    }
    /* ê²€ìƒ‰ ë²„íŠ¼(ë¨¸ë¦¬í–‰ë³´ë‹¤ ì‚´ì§ ì§„í•œ í†¤) */
    #searchBtn.primary{
      background: var(--btn-brand);
      border-color: var(--btn-brand-border);
      color: var(--brand-soft-text);
    }
    #searchBtn.primary:hover{ background: #CFE8F0; }
    #searchBtn.primary:focus{ box-shadow: 0 0 0 3px var(--ring); outline: none; }

    .count { font-size: 14px; color: var(--fg); font-weight: 600; margin: 6px 0 10px; }

    table { width: 100%; border-collapse: collapse; }
    thead th {
      position: sticky; top: 0; z-index: 1;
      background: var(--brand-soft);
      border-bottom: 1px solid var(--brand-soft-border);
      padding: 10px 8px; font-size: 13px; white-space: nowrap;
      text-align: center;
    }
    tbody td {
      border-bottom: 1px solid var(--line); padding: 10px 8px; font-size: 14px; text-align: center;
      vertical-align: middle;
    }
    td.title { text-align: left; }
    a.title-link { color: #1e40af; text-decoration: none; }
    a.title-link:hover { color: #1d4ed8; text-decoration: underline; }

    .empty, .error {
      border: 1px dashed var(--line); background: #fff; color: var(--muted);
      border-radius: 10px; padding: 16px; text-align: center; margin-top: 10px;
    }
    .error { color: #b91c1c; border-color: #fecaca; background: #fff7f7; }
    .note { font-size: 12px; color: var(--muted); margin-top: 6px; }

    #tbl th:nth-child(3), #tbl td:nth-child(3) { white-space: nowrap; }
  </style>

  <!-- ğŸ”§ ì „ì—­ ì˜¤ë¥˜ í•¸ë“¤ëŸ¬: JS ì—ëŸ¬/Promise ì˜¤ë¥˜ë¥¼ #metaì— í‘œì‹œ -->
  <script>
    (function(){
      function setMetaMessage(text){
        function apply(){
          var el = document.getElementById('meta');
          if (el) el.textContent = text;
        }
        if (document.readyState === 'loading'){
          document.addEventListener('DOMContentLoaded', apply, {once:true});
        } else {
          apply();
        }
      }
      window.addEventListener('error', function(e){
        // íŒŒì‹±/ì‹¤í–‰ ì—ëŸ¬ ë° ë¦¬ì†ŒìŠ¤ ì—ëŸ¬
        var msg = e.message || 'ìŠ¤í¬ë¦½íŠ¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
        setMetaMessage('ì˜¤ë¥˜: ' + msg);
      }, true);

      window.addEventListener('unhandledrejection', function(e){
        var r = e.reason;
        var msg = (r && (r.message || r)) || 'ì²˜ë¦¬ë˜ì§€ ì•Šì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
        setMetaMessage('ì˜¤ë¥˜: ' + msg);
      });
    })();
  </script>
</head>
<body>
  <div class="wrap">
    <!-- í—¤ë” -->
    <div class="header">
      <!-- ë¡œê³  í´ë¦­ ì‹œ ìƒˆë¡œê³ ì¹¨ -->
      <a id="logoLink" href="./" class="logo-link" aria-label="ë¡œê³ : ìƒˆë¡œê³ ì¹¨">
        <img src="./data/logo.png?v=1" alt="ë™ì•„ë¦¬ ë¡œê³ " class="logo" fetchpriority="high" />
      </a>
      <h1>1365 Â· ì„œìš¸ ( 1365 ì›¹ì‚¬ì´íŠ¸ ì ê²€ ì¤‘ )</h1>
      <div class="meta" id="meta">ë¡œë”© ì¤‘â€¦</div>
    </div>

    <!-- í•„í„° íŒ¨ë„ -->
    <div class="panel">
      <div class="row">
        <div style="grid-column: span 2;">
          <label for="q">í‚¤ì›Œë“œ (ì œëª©/ê¸°ê´€/ì¥ì†Œ)</label>
          <input id="q" type="text" placeholder="ì˜ˆ: í™˜ê²½, ì€í‰êµ¬ì²­, ì¬íƒë´‰ì‚¬ ë“±" />
        </div>
        <div style="grid-column: span 2;">
          <label for="rq">ë´‰ì‚¬ì§€ì—­ (í‚¤ì›Œë“œ)</label>
          <input id="rq" type="text" placeholder="ì˜ˆ: ê°•ë‚¨êµ¬, ì€í‰êµ¬, ì„œìš¸ ë“±" />
        </div>
        <div>
          <label for="minRecruit">ëª¨ì§‘ì¸ì› (ì´ìƒ)</label>
          <input id="minRecruit" type="number" min="0" step="1" placeholder="ì˜ˆ: 10" />
        </div>
        <div>
          <label>&nbsp;</label>
          <div class="actions" style="justify-content:flex-start;">
            <button id="searchBtn" class="primary">ê²€ìƒ‰</button>
            <button id="resetBtn">ì´ˆê¸°í™”</button>
          </div>
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div>
          <label for="from">ë´‰ì‚¬ê¸°ê°„ (ì‹œì‘)</label>
          <input id="from" type="date" />
        </div>
        <div>
          <label for="to">ë´‰ì‚¬ê¸°ê°„ (ë)</label>
          <input id="to" type="date" />
        </div>
        <div class="note" style="grid-column: span 4;">
          â€» ë´‰ì‚¬ê¸°ê°„ í•„í„°ëŠ” í™œë™ê¸°ê°„ì´ ì§€ì • ë²”ìœ„ì™€ <b>ê²¹ì¹˜ëŠ”</b> ê³µê³ ë§Œ ë‚¨ê¹ë‹ˆë‹¤.
        </div>
      </div>
    </div>

    <div class="count" id="count"></div>

    <div class="table-wrap">
      <table id="tbl">
        <thead>
          <tr>
            <th style="width:64px;">ë²ˆí˜¸</th>
            <th>ì œëª©</th>
            <th style="width:170px;">ë´‰ì‚¬ê¸°ê°„</th>
            <th style="width:140px;">ë´‰ì‚¬ì‹œê°„</th>
            <th style="width:140px;">ëª¨ì§‘ê¸°í•œ(ì¢…ë£Œ)</th>
            <th style="width:110px;">ëª¨ì§‘ì¸ì›</th>
            <th style="width:110px;">ì‹ ì²­ì¸ì›</th>
            <th style="width:180px;">ë“±ë¡ê¸°ê´€</th>
            <th style="width:200px;">ë´‰ì‚¬ì§€ì—­/ì¥ì†Œ</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="empty" class="empty" style="display:none;">ì¡°ê±´ì— ë§ëŠ” ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
      <div id="error" class="error" style="display:none;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>
    </div>
  </div>

  <script>
    // ---------- ìœ í‹¸ ----------
    const S = (v) => (v == null ? "" : String(v));
    const d8 = (v) => {
      const s = S(v).replace(/\D/g, "");
      return s.length >= 8 ? s.slice(0,8) : "99999999";
    };
    const fmtD8 = (v) => {
      const s = d8(v);
      return s === "99999999" ? "" : `${s.slice(0,4)}-${s.slice(4,6)}-${s.slice(6,8)}`;
    };
    const to8 = (yyyy_mm_dd) => S(yyyy_mm_dd).replace(/\D/g,"").slice(0,8);

    // ---------- ìƒíƒœ ----------
    let ALL = [];
    let META = { updatedAt: "", count: 0 };

    function setMeta() {
      const m = document.getElementById("meta");
      const when = META.updatedAt ? new Date(META.updatedAt).toLocaleString() : "-";
      m.textContent = `ìµœê·¼ ì—…ë°ì´íŠ¸: ${when} ( 2ì‹œê°„ë§ˆë‹¤ ìë™ê°±ì‹  )`;
    }

    function setCount(n) {
      const total = META.count || 0;
      document.getElementById("count").textContent =
        `í‘œì‹œ: ${n} / ${total}ê±´ ( ì •ë ¬: ëª¨ì§‘ê¸°í•œ ì¢…ë£Œì¼ â†‘)`;
    }

    function linkFor(it) {
      return `https://www.1365.go.kr/vols/P9210/partcptn/timeCptn.do?type=show&progrmRegistNo=${encodeURIComponent(S(it.progrmRegistNo))}`;
    }

    function render(items) {
      // ëª¨ì§‘ê¸°í•œ(ì¢…ë£Œ) ê¸°ì¤€ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
      items = [...items].sort((a,b) => d8(a.noticeEndde).localeCompare(d8(b.noticeEndde)));

      const tbody = document.querySelector("#tbl tbody");
      if (!items.length) {
        tbody.innerHTML = "";
        document.getElementById("empty").style.display = "block";
        setCount(0);
        return;
      }
      document.getElementById("empty").style.display = "none";

      tbody.innerHTML = items.map((it, i) => {
        const volDate =
          (it.progrmBgnde && it.progrmEndde)
            ? `${fmtD8(it.progrmBgnde)} ~ ${fmtD8(it.progrmEndde)}`
            : "";

        const noticeEnd = fmtD8(it.noticeEndde) || "-";

        const time =
          (S(it.actBeginTm) && S(it.actEndTm))
            ? `${S(it.actBeginTm).padStart(2,"0")}:${S(it.actBeginMnt||"00").padStart(2,"0")} ~ ${S(it.actEndTm).padStart(2,"0")}:${S(it.actEndMnt||"00").padStart(2,"0")}`
            : "-";

        return `
          <tr>
            <td>${i+1}</td>
            <td class="title"><a class="title-link" href="${linkFor(it)}" target="_blank" rel="noopener">${S(it.progrmSj)}</a></td>
            <td>${volDate}</td>
            <td>${time}</td>
            <td>${noticeEnd}</td>
            <td>${S(it.rcritNmpr) || "-"}</td>
            <td>${S(it.aplyNmpr)  || "-"}</td>
            <td>${S(it.nanmmbyNm) || "-"}</td>
            <td>${S(it.actPlace)   || "-"}</td>
          </tr>
        `;
      }).join("");

      setCount(items.length);
    }

    function applyFilter() {
      const q  = document.getElementById("q").value.trim();
      const rq = document.getElementById("rq").value.trim();
      const minRecruit = document.getElementById("minRecruit").value.trim();
      const from = document.getElementById("from").value;
      const to   = document.getElementById("to").value;

      const from8 = from ? to8(from) : "";
      const to8v  = to   ? to8(to)   : "";

      let out = ALL;

      if (q) {
        const qq = q.toLowerCase();
        out = out.filter(it => {
          const hay = (S(it.progrmSj) + " " + S(it.mnnstNm) + " " + S(it.nanmmbyNm) + " " + S(it.actPlace)).toLowerCase();
          return hay.includes(qq);
        });
      }

      if (rq) {
        const rr = rq.toLowerCase();
        out = out.filter(it => {
          const hay = (S(it.actPlace) + " " + S(it.nanmmbyNm)).toLowerCase();
          return hay.includes(rr);
        });
      }

      if (minRecruit) {
        const need = parseInt(minRecruit, 10);
        if (!isNaN(need)) {
          out = out.filter(it => {
            const n = parseInt(S(it.rcritNmpr).replace(/\D/g,"") || "0", 10);
            return n >= need;
          });
        }
      }

      if (from8 || to8v) {
        out = out.filter(it => {
          const bg = d8(it.progrmBgnde);
          const ed = d8(it.progrmEndde);
          if (bg === "99999999" && ed === "99999999") return false;
          const s = from8 || "00000000";
          const e = to8v  || "99999999";
          return (ed >= s) && (bg <= e);
        });
      }

      render(out);
    }

    function resetFilter() {
      document.getElementById("q").value = "";
      document.getElementById("rq").value = "";
      document.getElementById("minRecruit").value = "";
      document.getElementById("from").value = "";
      document.getElementById("to").value = "";
      render(ALL);
    }

    (async function init(){
      try {
        const res = await fetch("./data/1365.json", { cache: "no-store" });
        if (!res.ok) throw new Error("HTTP " + res.status);
        const j = await res.json();

        META.updatedAt = j.updatedAt || "";
        META.count     = j.count || (Array.isArray(j.items) ? j.items.length : 0);
        setMeta();

        ALL = Array.isArray(j.items) ? j.items : [];
        render(ALL);
      } catch (err) {
        console.error(err);
        document.getElementById("error").style.display = "block";
        document.querySelector("#tbl tbody").innerHTML = "";
        setCount(0);
        // â–¼ ì—ëŸ¬ ë‚´ìš©ì„ ë©”íƒ€ ìë¦¬ì— ëª…ì‹œ
        const msg = (err && (err.message || String(err))) || 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.';
        document.getElementById("meta").textContent = `ì˜¤ë¥˜: ${msg}`;
      }

      document.getElementById("searchBtn").addEventListener("click", (e)=>{ e.preventDefault(); applyFilter(); });
      document.getElementById("resetBtn").addEventListener("click", (e)=>{ e.preventDefault(); resetFilter(); });

      ["q","rq","minRecruit","from","to"].forEach(id=>{
        const el = document.getElementById(id);
        el.addEventListener("keydown", (e)=>{ if (e.key === "Enter") { e.preventDefault(); applyFilter(); } });
      });

      // âœ… ë¡œê³  í´ë¦­ ì‹œ ìƒˆë¡œê³ ì¹¨
      const logoLink = document.getElementById('logoLink');
      if (logoLink){
        logoLink.addEventListener('click', (e)=>{
          e.preventDefault();
          window.location.reload();
        });
      }
    })();
  </script>
</body>
</html>






